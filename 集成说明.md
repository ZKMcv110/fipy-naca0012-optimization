# C++程序与Python脚本集成说明

本项目需要与C++几何生成程序集成，以根据输入参数自动生成翼型坐标数据文件。

## 集成要求

1. C++程序需要接受4个参数：Tt, Ts, Tad, Tb
2. 程序执行后应生成`airfoil_array_SYMMETRIC.dat`文件
3. Python脚本将调用该程序并传入参数

## 集成方法

### 1. 修改Python调用代码

在`run_optimization_case.py`文件中，找到以下函数：

```python
def run_cplusplus_geometry_engine(Tt, Ts, Tad, Tb):
    """
    调用C++几何引擎生成几何文件
    """
    try:
        # 假设C++程序名为 geometry_engine.exe，接受4个参数
        # 您需要根据实际的C++程序接口修改此命令
        cmd = ["geometry_engine.exe", str(Tt), str(Ts), str(Tad), str(Tb)]
        result = subprocess.run(cmd, capture_output=True, text=True, check=True)
        print("C++几何引擎执行成功")
        print(result.stdout)
        return True
    except subprocess.CalledProcessError as e:
        print(f"C++几何引擎执行失败: {e}")
        print(f"错误输出: {e.stderr}")
        return False
    except FileNotFoundError:
        print("未找到C++几何引擎程序 (geometry_engine.exe)")
        return False
```

### 2. 根据实际情况修改以下内容：

1. **程序名称**：将`geometry_engine.exe`替换为实际的C++程序名称
2. **参数顺序**：确保参数传递顺序与C++程序要求一致
3. **程序路径**：如果程序不在项目目录中，需要提供完整路径

### 3. 示例修改

假设您的C++程序名为`airfoil_generator.exe`，位于项目目录中：

```python
def run_cplusplus_geometry_engine(Tt, Ts, Tad, Tb):
    """
    调用C++几何引擎生成几何文件
    """
    try:
        cmd = ["airfoil_generator.exe", str(Tt), str(Ts), str(Tad), str(Tb)]
        result = subprocess.run(cmd, capture_output=True, text=True, check=True)
        print("C++几何引擎执行成功")
        print(result.stdout)
        return True
    except subprocess.CalledProcessError as e:
        print(f"C++几何引擎执行失败: {e}")
        print(f"错误输出: {e.stderr}")
        return False
    except FileNotFoundError:
        print("未找到C++几何引擎程序 (airfoil_generator.exe)")
        return False
```

### 4. 如果程序位于特定路径

```python
def run_cplusplus_geometry_engine(Tt, Ts, Tad, Tb):
    """
    调用C++几何引擎生成几何文件
    """
    try:
        # 假设程序位于 C:\tools\airfoil_generator.exe
        cmd = [r"C:\tools\airfoil_generator.exe", str(Tt), str(Ts), str(Tad), str(Tb)]
        result = subprocess.run(cmd, capture_output=True, text=True, check=True)
        print("C++几何引擎执行成功")
        print(result.stdout)
        return True
    except subprocess.CalledProcessError as e:
        print(f"C++几何引擎执行失败: {e}")
        print(f"错误输出: {e.stderr}")
        return False
    except FileNotFoundError:
        print("未找到C++几何引擎程序")
        return False
```

## 测试集成

修改完成后，可以通过以下方式测试集成是否成功：

1. 手动运行C++程序测试：
   ```
   airfoil_generator.exe 1.0 1.0 0.5 0.5
   ```

2. 运行单个优化案例测试：
   ```
   python run_optimization_case.py 1.0 1.0 0.5 0.5
   ```

## 常见问题

### 1. 程序路径问题

如果出现"未找到程序"错误，请检查：
- 程序名称是否正确
- 程序是否在系统PATH中
- 是否提供了完整路径

### 2. 参数传递问题

如果C++程序无法正确解析参数，请检查：
- 参数顺序是否正确
- 参数类型是否匹配
- 是否需要额外的命令行标志

### 3. 输出文件问题

确保C++程序生成的文件名为`airfoil_array_SYMMETRIC.dat`，并位于项目根目录。

## 注意事项

1. 确保C++程序在执行过程中不会弹出图形界面，以免阻塞自动化流程
2. 程序应正确处理各种输入参数组合
3. 程序应具有良好的错误处理机制，并返回适当的退出代码
4. 生成的文件格式应与现有`airfoil_array_SYMMETRIC.dat`文件兼容